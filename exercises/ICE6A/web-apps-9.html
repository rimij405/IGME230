<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8" />
        <title>Web Application 9</title>
        <link type="text/css" rel="stylesheet" href="css/main.css" />     
        <script>

        window.onload = function() { 
            /* This stuff happens "onload" */
            // declare some constants
            const nameField = document.querySelector("#nameField");
            const colorSelect = document.querySelector("#colorSelect");
            const prefix = "abc1234-";
            const nameKey = prefix + "name"
            const colorKey = prefix + "color";

            // grab the stored data, will return null if user has never been to this page
            const storedName = localStorage.getItem(nameKey);
            const storedColor = localStorage.getItem(colorKey);

            // if we find a previously set name value, display it
            if (storedName){
                nameField.value = storedName;
            }else{
                nameField.value = "Turbo";
            }

            // if we find a previously set color value, display it
            if (storedColor){
                colorSelect.querySelector(`option[value='${storedColor}']`).selected = true;
                document.body.style.backgroundColor = storedColor;
            }

            /* This stuff happens later when the user does something */
            // when the user changes their favorites, update localStorage
            nameField.onchange = e=>{ localStorage.setItem(nameKey, e.target.value); };
            colorSelect.onchange = e=>{ 
                localStorage.setItem(colorKey, e.target.value);
                document.body.style.backgroundColor = e.target.value;
            };
        }

        </script>
    </head>
    
    <body>

        <div id="id_wrapper">
            <div id="id_message">
                What is your name -> <input type='text' id='nameField'>
            </div>
            
            <div id="id_tasks">
                <span>Choose a color.</span>
                <div>
                What is your favorite color -> 
                <select id="colorSelect">
                    <option value="red">Red</option>
                    <option value="green">Green</option>
                    <option value="blue">Blue</option>
                    <option value="magenta">Magenta</option>
                    <option value="cyan">Cyan</option>
                    <option value="white">White</option>
                    <option value="gray">Gray</option>
                </select>
                </div>         
            </div>

        </div>
                
        <footer>
            <p>&copy; Copyright 2017 - Ian Effendi</p>
            <p class="caption"><a href="index.html">Return to Exercises</a>.</p>
        </footer>   
        
    </body>    
</html>